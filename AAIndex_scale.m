function AAIndex_composition=AAIndex_scale(Seq)
% Seq: N*M; N denotes smaple (line), M denotes the number of atributes
% AAIndex_composition: N*(M*14);   需要按列归一化的AAIndex，
% N: 行数,表示数据个数;
% M: 列数,表示序列长度，14为选取的AAIndex中的特征数目
[m,n]=size(Seq);
model=['A'    'R'    'N'    'D'    'C'    'Q'    'E'  ...
    'G'    'H'    'I'    'L'    'K'    'M'    'F' ...  
    'P'    'S'    'T'    'W'    'Y'    'V'   'X'];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%未归一化的AAindexModel,行是氨基酸个数21，列是物化性质个数14个
AAindexModel=[27.5   105.0    58.7    40.0    44.6    80.7    62.0     0.0    79.0    93.5   93.5   100.0    94.1   115.5    41.9    29.3    51.3   145.5   117.3    71.5     0;...
  8.1    10.5    11.6    13.0     5.5    10.5    12.3     9.0    10.4     5.2   4.9    11.3     5.7     5.2     8.0     9.2     8.6     5.4     6.2     5.9      0;...
 0.046   0.291   0.134   0.105   0.128   0.180   0.151   0.000   0.230   0.186  0.186   0.219   0.221   0.290   0.131   0.062   0.108   0.409   0.298   0.140    0;...
  0.5     0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.5     1.8   1.8     0.0     1.3     2.5     0.0     0.0     0.4     3.4     2.3     1.5      0;...
  93.7   250.4   146.3   142.6   135.2   177.7   182.9    52.6   188.1   182.2  173.7   215.2   197.6   228.6     0     109.5   142.1   271.6   239.9   157.2    0;...
   0       1      0      -1        0      0       -1      0        0       0      0      1       0       0        0       0       0       0       0      0       0;...
  89.09  174.20  132.12  133.10  121.15  146.15  147.13   75.07  155.16  131.17  131.17  146.19  149.21  165.19  115.13  105.09  119.12  204.24  181.19  117.15  0;...
  9.69    8.99    8.80    9.60    8.35    9.13    9.67    9.78    9.17    9.68    9.60    9.18    9.21    9.18   10.64    9.21    9.10    9.44    9.11    9.62   0;...
  2.34    1.82    2.02    1.88    1.92    2.17    2.10    2.35    1.82    2.36    2.36    2.16    2.28    2.16    1.95    2.19    2.09    2.43    2.20    2.32   0;...
   297     238     236     270     178     185     249     290     277     284    337     224     283     284     222     228     253     282     344     293    0;...
  1.80   12.50   -5.60    5.05  -16.50    6.30   12.00    0.00  -38.50   12.40  -11.00   14.60  -10.00  -34.50  -86.20   -7.50  -28.00  -33.70  -10.00    5.63   0;...
  154.33  341.01  207.90  194.91  219.79  235.51  223.16  127.90  242.54  233.21  232.30  300.46  202.65  204.74  179.93  174.06  205.80  237.01  229.15  207.60 0;...
  29.22   26.37   38.30   37.09   50.70   44.02   41.84   23.71   59.64   45.00   48.03   57.10   69.32   48.52   36.13   32.40   35.20   56.92   51.73   40.35  0;...
  30.88   68.43   41.70   40.66   53.83   46.62   44.98   24.74   65.99   49.71  50.62   63.21   55.32   51.06   39.21   35.65   36.50   60.00   51.15   42.75   0]';


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%以下是按行列一化的AAindexModel，因为每列是一个物化性质
AAindexModel=[0.189003436426117,0.623076923076923,0.112469437652812,0.147058823529412,0.344992636229750,0.500000000000000,0.436202506854681,0.910714285714286,0.962962962962963,0.863372093023256,0.873015873015873,0.452567373390810,0.421523369878823,0.451264065468362;
    0.721649484536083,0.807692307692308,0.711491442542787,0,0.921944035346097,1,0.852918135526831,0.844924812030075,0.748971193415638,0.691860465116279,0.979166666666667,1,0.380409694171956,1;
    0.403436426116839,0.892307692307692,0.327628361858191,0,0.538659793814433,0.500000000000000,0.646886016451234,0.827067669172932,0.831275720164609,0.686046511627907,0.799603174603175,0.609659540775930,0.552510098095788,0.609381850065761;
    0.274914089347079,1,0.256723716381418,0,0.525036818851252,0,0.651684292988641,0.902255639097744,0.773662551440329,0.784883720930233,0.905257936507937,0.571566816222398,0.535054818234276,0.594183837498173;
    0.306529209621993,0.423076923076923,0.312958435207824,0,0.497790868924889,0.500000000000000,0.593174696435566,0.784774436090226,0.790123456790123,0.517441860465116,0.691468253968254,0.644526553473505,0.731390652048471,0.786643285108870;
    0.554639175257732,0.807692307692308,0.440097799511003,0,0.654270986745213,0.500000000000000,0.715579710144928,0.858082706766917,0.893004115226337,0.537790697674419,0.917658730158730,0.690624908360459,0.635025966532026,0.681280140289347;
    0.426116838487973,0.946153846153846,0.369193154034230,0,0.673416789396171,0,0.720377986682334,0.908834586466165,0.864197530864198,0.723837209302326,0.974206349206349,0.654408961614029,0.603577611079054,0.657314043548151;
    0,0.692307692307692,0,0,0.193667157584683,0.500000000000000,0.367557775166471,0.919172932330827,0.967078189300412,0.843023255813954,0.855158730158730,0.375062314888126,0.342036930178881,0.361537337425106;
    0.542955326460481,0.800000000000000,0.562347188264059,0.147058823529412,0.692562592047128,0.500000000000000,0.759694477085781,0.861842105263158,0.748971193415638,0.805232558139535,0.473214285714286,0.711240139585349,0.860357761107905,0.964343124360660;
    0.642611683848797,0.400000000000000,0.454767726161369,0.529411764705882,0.670839469808542,0.500000000000000,0.642234625930278,0.909774436090226,0.971193415637860,0.825581395348837,0.978174603174603,0.683880238116184,0.649163300634738,0.726435773783428;
    0.642611683848797,0.376923076923077,0.454767726161369,0.529411764705882,0.639543446244477,0.500000000000000,0.642234625930278,0.902255639097744,0.971193415637860,0.979651162790698,0.746031746031746,0.681211694671711,0.692873629544143,0.739734034780067;
    0.687285223367698,0.869230769230769,0.535452322738386,0,0.792341678939617,1,0.715775558166862,0.862781954887218,0.888888888888889,0.651162790697675,1,0.881088531128119,0.823716099249856,0.923717667689610;
    0.646735395189003,0.438461538461538,0.540342298288509,0.382352941176471,0.727540500736377,0.500000000000000,0.730562083822953,0.865601503759399,0.938271604938271,0.822674418604651,0.755952380952381,0.594264097827043,1,0.808417360806664;
    0.793814432989691,0.400000000000000,0.709046454767726,0.735294117647059,0.841678939617084,0.500000000000000,0.808803368585977,0.862781954887218,0.888888888888889,0.825581395348837,0.512896825396826,0.600392950353362,0.699942296595499,0.746163963174046;
    0.287972508591065,0.615384615384615,0.320293398533007,0,0,0.500000000000000,0.563699569134352,1,0.802469135802469,0.645348837209302,0,0.527638485674907,0.521206001154068,0.572994300745287;
    0.201374570446735,0.707692307692308,0.151589242053790,0,0.403166421207658,0.500000000000000,0.514541715628672,0.865601503759399,0.901234567901235,0.662790697674419,0.780753968253968,0.510424914225389,0.467397576457011,0.520970334648546;
    0.352577319587629,0.661538461538462,0.264058679706601,0.117647058823529,0.523195876288660,0.500000000000000,0.583235409322366,0.855263157894737,0.860082304526749,0.735465116279070,0.577380952380952,0.603501363596376,0.507789959607617,0.533391787227824;
    1,0.415384615384615,1,1,1,0.500000000000000,1,0.887218045112782,1,0.819767441860465,0.520833333333333,0.695023606345855,0.821119446047317,0.876808417360807;
    0.806185567010309,0.476923076923077,0.728606356968215,0.676470588235294,0.883284241531664,0.500000000000000,0.887142577359969,0.856203007518797,0.905349794238683,1,0.755952380952381,0.671974428902378,0.746249278707444,0.747479175800088;
    0.491408934707904,0.453846153846154,0.342298288508558,0.441176470588235,0.578792341678940,0.500000000000000,0.573589894242068,0.904135338345865,0.954732510288066,0.851744186046512,0.911011904761905,0.608779801178851,0.582083092902481,0.624725997369575;
    0,0,0,0,0,0.500000000000000,0,0,0,0,0.855158730158730,0,0,0;];


AAIndex_composition=[];
for i=1:m
    AAIndex_row=[];
    for j=1:n
        for l=1:21 
            if Seq(i,j)==model(l)
                AAIndex_ele=AAindexModel(l,:); 
            end
        end
        AAIndex_row=[AAIndex_row, AAIndex_ele];
    end
    AAIndex_composition= [AAIndex_composition; AAIndex_row];
end
